
function query_tester(db,query,cb){
    var mysql      = require('mysql');
    var connection = mysql.createConnection({
        host     : db.host,
        user     : db.user,
        password : db.password,
        database:db.name
    });

    connection.connect();

    connection.query(query, function(err, rows, fields) {
        if (err) {
            cb(err);
        }
        else{
            cb("succes")
        }

    });
}

function all_columns(db,table,cb){
    var mysql      = require('mysql');
    var connection = mysql.createConnection({
        host     : db.host,
        user     : db.user,
        password : db.password,
        database:db.name
    });
    connection.connect();
    var query="select table_name, group_concat(COLUMN_NAME)as columns from information_schema.columns   where table_schema = '"+db.name+"' group by table_name order by table_name,ordinal_position";
    connection.query(query, function(err, rows, fields) {
        if (err) {
            cb(err);
        }
        else{
            var ret={}
            _.each(rows,function(row){
                ret[row.table_name]=row.columns.split(',');

            })
            cb(ret)
        }

    });
}



exports.query_tester=query_tester;
exports.all_columns=all_columns;